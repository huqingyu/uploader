/*!build time : 2014-04-24 5:50:23 PM*/
KISSY.add("1.5.4/type/base",function(a,b,c){function d(a){var b=this;d.superclass.constructor.call(b,a)}{var e="";b.all}return a.mix(d,{event:{START:"start",STOP:"stop",SUCCESS:"success",ERROR:"error"}}),a.extend(d,c,{upload:function(){},stop:function(){},_processResponse:function(b){var c=this,d=c.get("filter"),f={};if(a.isString(b))try{f=a.JSON.parse(b),d!=e&&(f=d.call(c,b)),f=c._fromUnicode(f)}catch(g){var h=b+", responseText is not json format.";a.log(h),c.fire("error",{status:-1,result:{msg:h}})}else a.isObject(b)&&(d!=e&&(f=d.call(c,b)),f=c._fromUnicode(b));return a.log("Server output\uff1a"+a.JSON.stringify(f)),f},_fromUnicode:function(b){function c(b){a.each(b,function(d,e){a.isObject(b[e])?c(b[e]):b[e]=a.isString(d)&&a.fromUnicode(d)||d})}return a.isObject(b)?(c(b),b):b}},{ATTRS:{action:{value:e},data:{value:{}},filter:{value:e}}}),d},{requires:["node","base"]}),KISSY.add("1.5.4/type/iframe",function(a,b,c){function d(a){var b=this;d.superclass.constructor.call(b,a)}var e="",f=b.all,g="[uploader-iframeType]:",h="ks-uploader-iframe-";return a.mix(d,{tpl:{IFRAME:'<iframe src="javascript:false;" name="{id}" id="{id}" border="no" width="1" height="1" style="display: none;" />',FORM:'<form method="post" enctype="multipart/form-data" action="{action}" target="{target}" style="visibility: hidden;">{hiddenInputs}</form>',HIDDEN_INPUT:'<input type="hidden" name="{name}" value="{value}" />'},event:a.mix(c.event,{CREATE:"create",REMOVE:"remove"})}),a.extend(d,c,{upload:function(b){var c,e=this,h=f(b);return h.length?(e.fire(d.event.START,{input:h}),e.set("fileInput",h),e._create(),(c=e.get("form"))?void c.getDOMNode().submit():(a.log(g+"form node not exists!"),!1)):!1},stop:function(){var a=this,b=a.get("iframe");return b.attr("src",'javascript:"<html></html>";'),a._remove(),a.fire(d.event.STOP),a.fire(d.event.ERROR,{status:"abort",msg:"upload failed: abort"}),a},dataToHidden:function(b){if(!a.isObject(b)||a.isEmptyObject(b))return"";var c=this,d=e,f=c.get("tpl"),g=f.HIDDEN_INPUT;if(!a.isString(g))return"";for(var h in b)d+=a.substitute(g,{name:h,value:b[h]});return d},_createIframe:function(){var b,c,d=this,e=h+a.guid(),i=d.get("tpl"),j=i.IFRAME,k=d.get("iframe");return a.isEmptyObject(k)?a.isString(j)?a.isString(e)?(b=a.substitute(i.IFRAME,{id:e}),c=f(b),d.get("domain")||c.on("load",d._iframeLoadHandler,d),f("body").append(c),d.set("id",e),d.set("iframe",c),f("body").data("UPLOAD_TYPE",d),c):(a.log(g+"id not exist or id is not string!"),!1):(a.log(g+"the template of iframe invalid!"),!1):k},handleResult:function(a){var b=this;a=b._processResponse(a),b.fire(d.event.SUCCESS,{result:a}),b._remove()},_iframeLoadHandler:function(b){var c=this,f=b.target,g=d.event.ERROR;try{var h=f.contentDocument||window.frames[f.id].document;if(!h||!h.body)return c.fire(g,{msg:"Server data returned error!"}),!1;var i=h.body.innerHTML;if(i==e)return!1;c.handleResult(i)}catch(j){a.log(j)}},_createForm:function(){var b,c,d,e=this,h=e.get("id"),i=e.get("tpl"),j=i.FORM,k=e.get("data"),l=e.get("action"),m=e.get("fileInput");return a.isString(j)?a.isString(l)?(b=e.dataToHidden(k),b+=e.dataToHidden({type:"iframe"}),d=a.substitute(j,{action:l,target:h,hiddenInputs:b}),c=f(d).append(m),f("body").append(c),e.set("form",c),c):(a.log(g+"action parameter invalid!"),!1):(a.log(g+"form template invalid!"),!1)},_create:function(){var a=this,b=a._createIframe(),c=a._createForm();a.fire(d.event.CREATE,{iframe:b,form:c})},_remove:function(){var a=this,b=a.get("form");return b?(b.remove(),a.reset("form"),void a.fire(d.event.REMOVE,{form:b})):!1}},{ATTRS:{tpl:{value:d.tpl},id:{value:h+a.guid()},domain:{value:e},iframe:{value:{}},form:{value:e},fileInput:{value:e}}}),d},{requires:["node","./base"]}),KISSY.add("1.5.4/type/ajax",function(a,b,c,d){function e(a){var b=this;e.superclass.constructor.call(b,a),b._setWithCredentials()}var f="",g=b.all,h="[uploader-AjaxType]:";return a.mix(e,{event:a.merge(c.event,{PROGRESS:"progress"})}),a.extend(e,c,{upload:function(b){var c=this;if(!b)return a.log(h+"upload(), fileData parameter invalid! "),c;var d=c.get("blobSize");return d>0?c._chunkedUpload(b):c._fullUpload(b),c},stop:function(){var b=this,c=b.get("ajax");return a.isObject(c)?(c.abort(),b.fire(e.event.STOP),b):(a.log(h+"stop(), the value of io invalid!"),b)},_getFormData:function(b){return g.isArray(b)?b:a.isObject(b)?(b=[],g.each(b,function(a,c){b.push({name:a,value:c})}),b):b},_setWithCredentials:function(){var b=this,c=(b.get("CORS"),b.get("ajaxConfig"));return a.mix(c,{xhrFields:{withCredentials:!0}}),c},_setFormData:function(){var b=this;try{b.set("formData",new FormData),b._processData()}catch(c){a.log(h+"something error when reset FormData.")}},_resetFormData:function(){var a=this;a.set("formData",new FormData)},_processData:function(){var b=this,c=b.get("data"),d=b.get("formData");a.each(c,function(a,b){d.append(b,a)}),b.set("formData",d)},_addFileData:function(b){if(!a.isObject(b))return a.log(h+"_addFileData(), file parameter invalid!"),!1;var c=this,d=c.get("formData"),e=c.get("fileDataName"),f=b.name;return d.append(e,b,f),c.set("formData",d),d},_chunkedUpload:function(b){function c(){var h=l.call(b,j,j+k,b.type),m=h.size;f._setContentDisposition(b.name),f._setContentRange(j,m,i),f._setFormData(),f._addFileData(h),a.mix(g,{data:f.get("formData")});var n=d(g);n.then(function(a){var b=a[0];j=f._getUploadedBytes(n)||j+m,f.fire(e.event.PROGRESS,{loaded:j,total:i}),i>j?c():f.fire(e.event.SUCCESS,{result:b})},function(a){f._errorHandler(a,b)})}if(!a.isObject(b))return!1;var f=this,g=f.get("ajaxConfig"),h=f.get("action");a.mix(g,{url:h});var i=b.size,j=0,k=f.get("blobSize")||i,l=b.slice||b.webkitSlice||b.mozSlice;c()},_fullUpload:function(b){var c=this,f=c.get("ajaxConfig");c._setFormData(),c._addFileData(b),a.mix(f,{data:c.get("formData"),url:c.get("action")});var g=d(f);return g.then(function(a){var b=a[0];b=c._processResponse(b),c.fire(e.event.SUCCESS,{result:b})},function(a){c._errorHandler(a,b)}),c.set("ajax",g),g},_errorHandler:function(a,b){var c=this,d={},f=a[1];"timeout"==f&&(d.msg="timeout!",d.status="timeout"),c.fire(e.event.ERROR,{status:f,result:d,file:b})},_getUploadedBytes:function(a){var b=a.getResponseHeader("Range"),c=b&&b.split("-"),d=c&&c.length>1&&parseInt(c[1],10);return d&&d+1},_setContentRange:function(a,b,c){var d="bytes "+a+"-"+(a+b-1)+"/"+c,e=this,f=e.get("ajaxConfig"),g=f.headers;return g["Content-Range"]=d,d},_setContentDisposition:function(a){return this._setRequestHeader("Content-Disposition",'attachment; filename="'+encodeURI(a)+'"')},_setRequestHeader:function(a,b){var c=this,d=c.get("ajaxConfig");return d.headers[a]=b,c.set("ajaxConfig",d),b}},{ATTRS:{formData:{value:f},ajaxConfig:{value:{type:"post",processData:!1,cache:!1,dataType:"json",contentType:!1,timeout:10,headers:{}}},ajax:{value:f},fileDataName:{value:f},form:{value:{}},fileInput:{value:f},blobSize:{value:0},CORS:{value:!1},isUsePostMessage:{value:!1}}}),e},{requires:["node","./base","ajax"]}),KISSY.add("1.5.4/button/base",function(a,b,c){function d(b,c){var e=this;c=a.merge({target:g(b)},c),d.superclass.constructor.call(e,c)}var e="",f="[Uploader-Button] ",g=b.all;return a.mix(d,{event:{beforeShow:"beforeShow",afterShow:"afterShow",beforeHide:"beforeHide",afterHide:"afterHide",beforeRender:"beforeRender",afterRender:"afterRender",CHANGE:"change"},getFileName:function(a){return a.replace(/.*(\/|\\)/,"")}}),a.extend(d,c,{render:function(){var b=this,c=b.get("srcFileInput");if(!c||!c.length)return a.log("[Button]file element not exists!"),b;var d=c.clone();d.addClass("file-input"),c.remove(),b.set("srcFileInput",d),b._createInput()},show:function(){var a=this,b=a.get("target");return b.show(),a.fire(d.event.afterShow),d},hide:function(){var a=this,b=a.get("target");return b.hide(),a.fire(d.event.afterHide),d},reset:function(){var a=this,b=a.get("inputContainer");return g(b).remove(),a.set("inputContainer",e),a.set("fileInput",e),a._createInput(),a},_createInput:function(){var b=this,c=b.get("target"),d=(b.get("name"),b.get("tpl"));if(!a.isString(d))return!1;var e=b.get("srcFileInput");if(!e.length)return!1;var f=e.clone();b.set("fileInput",f);var h=g(d);return h.append(f),h.appendTo(c),6==a.UA.ie&&f.css("fontSize","400px"),g(f).on("change",b._changeHandler,b),b.set("inputContainer",h),b._setDisabled(b.get("disabled")),b._setMultiple(b.get("multiple")),h},_changeHandler:function(b){var c=this,h=c.get("fileInput"),i=g(h).val(),j=b.target.files,k=[];return i==e?(a.log(f+"No file selected."),!1):(j?a.each(j,function(b){a.isObject(b)&&k.push({name:b.name,type:b.type,size:b.size,data:b})}):k.push({name:d.getFileName(i)}),c.fire(d.event.CHANGE,{files:k,input:h.getDOMNode()}),void c.reset())},_setDisabled:function(b){var c=this,d=c.get("cls"),e=d.disabled,f=c.get("target"),h=c.get("fileInput");return f.length&&a.isBoolean(b)?(b?(f.addClass(e),g(h).hide()):(f.removeClass(e),g(h).show()),b):!1},_setMultiple:function(a){var b=this,c=b.get("fileInput");return c.length?(a&&c.attr("multiple","multiple")||c.removeAttr("multiple"),a):!1}},{ATTRS:{target:{value:null},fileInput:{value:e},srcFileInput:{value:e},inputContainer:{value:e},tpl:{value:'<div class="file-input-wrapper" style="overflow: hidden;"></div>'},name:{value:"fileInput",setter:function(a){return this.get("fileInput")&&g(this.get("fileInput")).attr("name",a),a}},disabled:{value:!1,setter:function(a){return this._setDisabled(a),a}},multiple:{value:!0,setter:function(a){return this._setMultiple(a),a}},cls:{value:{disabled:"uploader-button-disabled"}}}}),d},{requires:["node","base"]}),KISSY.add("1.5.4/queue",function(a,b,c){function d(a){var b=-1;do a/=1024,b++;while(a>99);return Math.max(a,.1).toFixed(1)+["KB","MB","GB","TB","PB","EB"][b]}function e(a){var b=this;e.superclass.constructor.call(b,a)}var f="",g=(b.all,"[uploader-queue]:");return a.mix(e,{event:{ADD:"add",ADD_FILES:"addFiles",REMOVE:"remove",CLEAR:"clear",FILE_STATUS:"statusChange",UPDATE_FILE:"updateFile"},status:{WAITING:"waiting",START:"start",PROGRESS:"progress",SUCCESS:"success",CANCEL:"cancel",ERROR:"error",RESTORE:"restore"},FILE_ID_PREFIX:"file-"}),a.extend(e,c,{add:function(b,c){var d=this,e={};if(b.length>0){e=[];var f=d.get("uploader"),g=d.get("files").length,h=f.get("max")>0;a.each(b,function(a,b){if(h){var c=f.get("max");c>=g+b+1&&e.push(d._addFile(a))}else e.push(d._addFile(a))})}else e=d._addFile(b);return c&&c.call(d),e},_addFile:function(b,c){if(!a.isObject(b))return a.log(g+'_addFile() the parameter "file" invalid!'),!1;var d=this,f=d._setAddFileData(b),h=d.getFileIndex(f.id),i=d.get("fnAdd");return a.isFunction(i)&&(f=i(h,f)),d.fire(e.event.ADD,{index:h,file:f,uploader:d.get("uploader")}),c&&c.call(d,h,f),f},remove:function(b,c){var d,f=this,h=f.get("files");return a.isString(b)&&(b=f.getFileIndex(b)),d=h[b],a.isObject(d)?(h=a.filter(h,function(a,c){return c!==b}),f.set("files",h),f.fire(e.event.REMOVE,{index:b,file:d}),c&&c.call(f,b,d),d):(a.log(g+'remove() index "'+b+'" exceeds number of files'),!1)},clear:function(){function a(){return b=c.get("files"),b.length?void c.remove(0,function(){a()}):(c.fire(e.event.CLEAR),!1)}var b,c=this;a()},fileStatus:function(b,c,d){if(!a.isNumber(b))return!1;{var f,g=this,h=g.getFile(b);g.get("theme")}return h?(f=h.status,c?f==c?g:(g.updateFile(b,{status:c}),g.fire(e.event.FILE_STATUS,{index:b,status:c,args:d,file:h}),g):f):!1},getFile:function(b){var c,d=this,e=d.get("files");return a.isNumber(b)?c=e[b]:a.each(e,function(a){return a.id==b?(c=a,!0):void 0}),c},getFileIndex:function(b){var c=this,d=c.get("files"),e=-1;return a.each(d,function(a,c){return a.id==b?(e=c,!0):void 0}),e},updateFile:function(b,c){if(!a.isNumber(b))return!1;if(!a.isObject(c))return a.log(g+'updateFile() the parameter "data" invalid!'),!1;var d=this,f=d.get("files"),h=d.getFile(b);return h?(a.mix(h,c),f[b]=h,d.set("files",f),d.fire(e.event.UPDATE_FILE,{index:b,file:h}),h):!1},getIndexs:function(b){var c,d=this,e=d.get("files"),f=[];return e.length?(a.each(e,function(d,e){a.isObject(d)&&(c=d.status,c==b&&f.push(e))}),f):f},getFiles:function(b){var c=this,d=c.get("files"),e=[];return d.length?(a.each(d,function(a){a&&a.status==b&&e.push(a)}),e):[]},_setAddFileData:function(b){var c=this,f=c.get("files");return a.isObject(b)?(b.id||(b.id=a.guid(e.FILE_ID_PREFIX)),b.size&&(b.textSize=d(b.size)),b.status||(b.status="waiting"),f.push(b),b):(a.log(g+'_updateFileData() the parameter "file" invalid!'),!1)}},{ATTRS:{fnAdd:{value:f},files:{value:[]},uploader:{value:f}}}),e},{requires:["node","base"]}),KISSY.add("1.5.4/index",function(a,b,c,d,e,f,g,h,i){var j="[uploader]:",k="",l=b.all,m="text/uploader-files",n=c.extend({constructor:function(a,b){var c=this;n.superclass.constructor.call(c,b),c.set("target",a),c._init()},_init:function(){var b=this,c=b.get("target");if(!c.length)return a.log("the target not exists!"),!1;var d=b.get("type"),e=b.getUploadType(d);return b._replaceBtn(),b._renderButton(),b._renderQueue(),b._renderUploaderCore(e),b},_replaceBtn:function(){var b=this,c=b.get("target");if(!c.length)return!1;var d=c[0].defaultValue||b.get("text"),e=a.substitute(b.get("btnTpl"),{text:d}),f=l(e).insertAfter(c);return!b.get("name")&&c.attr("name")&&b.set("name",c.attr("name")),b.set("_oldInput",c.clone()),b.set("fileInput",c),b.set("target",f),f},upload:function(b){if(!a.isNumber(b))return!1;var c,d=this,e=d.get("uploadType"),f=d.get("type"),g=d.get("queue"),h=g.get("files")[b];return a.isObject(h)?d.get("curUploadIndex")!=k?(alert("uploading index ..."+d.get("curUploadIndex")+", cannot operate before upload complete!"),!1):(c=h.input,"ajax"==f&&(c=h.data),"error"===h.status?!1:d.get("isAllowUpload")?(d.set("curUploadIndex",b),d.fire(n.event.START,{index:b,file:h}),g.fileStatus(b,n.status.START),void e.upload(c)):!1):(a.log(j+" the file index in queue: "+b),!1)},cancel:function(b){var c=this,d=c.get("uploadType"),e=c.get("queue"),f=n.status,g=e.fileStatus(b);return a.isNumber(b)&&g!=f.SUCCESS?(d.stop(),e.fileStatus(b,f.CANCEL)):(d.stop(),c._continueUpload()),c},stop:function(){var a=this;return a.set("uploadFilesStatus",k),a.cancel(),a},uploadFiles:function(b){var c=this;return a.isString(b)||(b=n.status.WAITING),c.set("uploadFilesStatus",b),c._uploaderStatusFile(b),c},_uploaderStatusFile:function(a){var b=this,c=b.get("queue"),d=c.getIndexs(a);return d.length?(b.upload(d[0]),b):(b.set("uploadFilesStatus",k),b.fire(n.event.UPLOAD_FILES),!1)},isSupportAjax:function(){var a=!1;try{FormData&&(a=!0)}catch(b){a=!1}return a},_renderUploaderCore:function(a){{var b=this;b.get("type")}if(!a)return!1;{var c={action:b.get("action"),data:b.get("data"),dataType:"json"};b.get("button")}c.fileDataName=b.get("name"),c.CORS=b.get("CORS");var d=new a(c),e=a.event;return d.on(e.SUCCESS,b._uploadCompleteHandler,b),d.on(e.ERROR,b._uploadCompleteHandler,b),e.PROGRESS&&d.on(e.PROGRESS,b._uploadProgressHandler,b),d.on(e.STOP,b._uploadStopHanlder,b),b.set("uploadType",d),d},getUploadType:function(b){var c,d=this,e=n.type;return b==e.AUTO&&(b=[e.AJAX,e.IFRAME]),a.isArray(b)&&b.length>0?a.each(b,function(a){return c=d._getType(a),c?!1:void 0}):c=d._getType(b),c},_getType:function(b){var c,d=this,e=n.type,h=d.isSupportAjax();switch(b){case e.IFRAME:c=f;break;case e.AJAX:c=h&&g||!1;break;default:return a.log(j+"type invalid"),!1}return c&&a.log(j+' using the type "'+b+'" to upload'),d.set("type",b),c},_renderButton:function(){var a,b,c=this,d=c.get("type"),f=c.get("target"),g=c.get("multiple"),i=c.get("disabled"),j=c.get("name"),k={name:j,multiple:g,disabled:i,srcFileInput:c.get("fileInput")};return b=h,a=new b(f,k),a.on("change",c._select,c),a.render(),c.set("button",a),d==n.type.IFRAME&&e.ie<10&&c.set("multiple",!1),a},_renderQueue:function(){var a=this,b=new i;return b.set("uploader",a),b.on("add",function(b){a.fire(n.event.ADD,b)}),b.on("remove",function(b){a.fire(n.event.REMOVE,b)}),a.set("queue",b),b},_select:function(b){var c=this,d=c.get("queue"),e=c.get("curUploadIndex"),f=b.files;return a.each(f,function(a){a.size||(a.size=0),a.name||(a.name=a.fileName||k),a.input=b.input||a}),f=c._processExceedMultiple(f),c.fire(n.event.SELECT,{files:f}),c.get("isAllowUpload")?void d.add(f,function(){e==k&&c.get("autoUpload")&&c.uploadFiles()}):!1},_processExceedMultiple:function(b){var c=this,d=c.get("multipleLen");return 0>d||!a.isArray(b)||!b.length?b:a.filter(b,function(a,b){return d>b})},_uploadCompleteHandler:function(b){var c,d=this,e=b.result,f=n.event,g=d.get("queue"),h=d.get("curUploadIndex");if(!a.isObject(e))return!1;if(g.updateFile(h,{result:e}),c=Number(e.status),1===c)g.fileStatus(h,n.status.SUCCESS),d._success(e.data),d.fire(f.SUCCESS,{index:h,file:g.getFile(h),result:e});else{var i=e.msg||e.message||k;e.msg=i,g.fileStatus(h,n.status.ERROR,{msg:i,result:e}),d.fire(f.ERROR,{msg:i,status:c,result:e,index:h,file:g.getFile(h)})}d.set("curUploadIndex",k),d.fire(f.COMPLETE,{index:h,file:g.getFile(h),result:e}),d._continueUpload()},_uploadStopHanlder:function(){var a=this,b=a.get("queue"),c=a.get("curUploadIndex");b.fileStatus(c,n.status.CANCEL),a.set("curUploadIndex",k),a.fire(n.event.CANCEL,{index:c})},_continueUpload:function(){var a=this,b=a.get("uploadFilesStatus");b!=k&&a._uploaderStatusFile(b)},_uploadProgressHandler:function(b){var c=this,d=c.get("queue"),e=c.get("curUploadIndex"),f=d.getFile(e);a.mix(b,{file:f}),d.fileStatus(e,n.status.PROGRESS,b),c.fire(n.event.PROGRESS,b)},_success:function(b){if(!a.isObject(b))return!1;var c=this,d=b.url,e=c.get("curUploadIndex"),f=c.get("queue");return a.isString(d)?void f.updateFile(e,{sUrl:d}):!1},theme:function(b){var c=this,d=c.get("theme");return b?d?(a.log("not support re-render theme!"),c):(b.set("uploader",c),b.set("queue",c.get("queue")),b.render&&b.render(),c.fire("themeRender",{theme:d,uploader:c}),c.set("theme",b),c):!1},restore:function(b){var c,e=this;if(e.set("hasRestore",!0),b){var f=l(b);if(!f.length)return a.log("restore(): target not exists!"),!1;c=f.text()}else{var g=e.get("theme");if(!g)return!1;var h=g.get("queueTarget");if(!h||!h.length)return!1;var i=h.all("script");i.each(function(a){a.attr("type")==m&&(c=a.html())})}if(c=d.parse(c),!c.length)return!1;var j,k=e.get("queue");a.each(c,function(a){a.status=1,j={type:"restore",name:a.name||"",url:a.url||"",result:a};var b=k.add(j),c=b.id,d=k.getFileIndex(c);k.fileStatus(d,"success",{index:d,id:c,file:b}),e.fire("success",{file:b,result:b.result})})}},{ATTRS:{target:{value:k,getter:function(a){return l(a)}},text:{value:"Upload File"},fileInput:{value:k},theme:{value:k},btnTpl:{value:'<a href="javascript:void(0)" class="g-u ks-uploader-button"><span class="btn-text">{text}</span></a>'},button:{value:{}},queue:{value:{}},type:{value:"auto"},multiple:{value:!1,setter:function(b){var c=this,d=c.get("button");return!a.isEmptyObject(d)&&a.isBoolean(b)&&d.set("multiple",b),b}},multipleLen:{value:-1},disabled:{value:!1,setter:function(b){var c=this,d=c.get("button");return!a.isEmptyObject(d)&&a.isBoolean(b)&&d.set("disabled",b),b}},action:{value:k,setter:function(b){var c=this,d=c.get("uploadType");return d&&!a.isEmptyObject(d)&&d.set("action",b),b}},data:{value:{},setter:function(b){if(a.isObject(b)){var c=this,d=c.get("uploadType");d&&!a.isEmptyObject(d)&&d.set("data",b)}return b}},isAllowUpload:{value:!0},autoUpload:{value:!0},filter:{value:k,setter:function(b){var c=this,d=c.get("uploadType");return d&&!a.isEmptyObject(d)&&d.set("filter",b),b}},curUploadIndex:{value:k},uploadType:{value:k},hasRestore:{value:!1},button:{value:{}},queue:{value:{}},curUploadIndex:{value:k},curFile:{value:k,getter:function(){var b=this,c=k,d=b.get("curUploadIndex");if(a.isNumber(d)){var e=b.get("queue");c=e.getFile(d)}return c}},uploadType:{value:{}},fileInput:{value:k},uploadFilesStatus:{value:k},CORS:{value:!1},timeout:{value:600,setter:function(b){var c=this,d=c.get("uploadType");return d&&!a.isEmptyObject(d)&&d.set("timeout",b),b}}}},"Uploader");return a.mix(n,{type:{AUTO:"auto",IFRAME:"iframe",AJAX:"ajax"},event:{SELECT:"select",ADD:"add",START:"start",PROGRESS:"progress",COMPLETE:"complete",SUCCESS:"success",UPLOAD_FILES:"uploadFiles",CANCEL:"cancel",ERROR:"error",REMOVE:"remove",RESTORE:"restore"},status:{WAITING:"waiting",START:"start",PROGRESS:"progress",SUCCESS:"success",CANCEL:"cancel",ERROR:"error"}}),n},{requires:["node","base","json","ua","./type/iframe","./type/ajax","./button/base","./queue"]}),KISSY.add("1.5.4/aliUploader",function(a,b,c){function d(){var a=arguments[1]||location.hostname,b=a.split("."),c=b.length,d=arguments[0]||(3>c?0:1);return(d>=c||2>c-d)&&(d=c-2),b.slice(d).join(".")}function e(b,c,e){var f=b.get("type"),g="iframe"==f;if(!g)return!1;var h=b.get("data");e||(c||(c=d(-2)),document.domain=c,h.domain=c,a.log("[AliUploader] auto set domain when cross domain: "+c)),h.type&&(delete h.type,a.log('invalid upload parameter name: "type", please change it.'));var i=b.get("uploadType");return i.set("domain",c),h}function f(b){var c=!1;b.on("add",function(){if(!c){var d=b.getPlugin("urlsInput");d&&(d.set("useName",!0),c=!0,a.log("[UrlsInput] the useName value set to true: Save the picture name returned from server"))}})}function g(d,g){g||(g={}),g.CORS=!0,g.action||a.log("setting config.action first please."),g.data||(g.data={}),g.data._input_charset="utf-8",b.ie<=6&&(g.type="iframe",a.log("IE6, using iframe."));var h=new c(d,g);return e(h,g.domain),g.useName&&f(h),h}return g.Uploader=c,g},{requires:["ua","./index"]});